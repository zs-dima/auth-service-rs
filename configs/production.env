# ============================================================================
# AUTH SERVICE CONFIGURATION
# ============================================================================

# ----------------------------------------------------------------------------
# SERVER
# ----------------------------------------------------------------------------
# Cloud Run sets PORT env var automatically (typically 8080)
# GRPC_ADDRESS is not needed when PORT is set
DOMAIN=auth-demo.dmitrii.app

# Enable gRPC-Web support for browser clients
GRPC_WEB=true

# Enable gRPC reflection API (useful for debugging with grpcurl)
GRPC_API_REFLECTION=false

# CORS allowed origins (comma-separated, or "*" for any)
CORS_ALLOW_ORIGINS=*

# Optional: Metrics
DISABLE_METRICS=true

# ----------------------------------------------------------------------------
# SECRETS
# ----------------------------------------------------------------------------
# Direct value or file-based (file takes precedence)
# JWT secret must be at least 32 characters
# JWT_SECRET_KEY=
# JWT_SECRET_KEY_FILE=/run/secrets/jwt_secret

# ----------------------------------------------------------------------------
# TOKEN TTLS
# ----------------------------------------------------------------------------
ACCESS_TOKEN_TTL_MINUTES=15
REFRESH_TOKEN_TTL_DAYS=7
PASSWORD_RESET_TTL_MINUTES=129600
EMAIL_VERIFICATION_TTL_HOURS=24

# ----------------------------------------------------------------------------
# LOGGING & OBSERVABILITY
# ----------------------------------------------------------------------------
# Levels: TRACE, DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO

# Enable JSON format for production log aggregation
JSON_LOGS=true

# Show backtraces on errors (0 = disabled, 1 = enabled)
BACKTRACE=0

# Environment name for telemetry
ENVIRONMENT=production

# OpenTelemetry OTLP endpoint (optional)
# OTLP_ENDPOINT=http://localhost:4317

# Sentry DSN for error tracking (optional)
# SENTRY_DSN=https://key@sentry.io/project

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------
CONCURRENCY_LIMIT=100
MAX_PHOTO_BYTES=2097152

# ----------------------------------------------------------------------------
# DATABASE
# ----------------------------------------------------------------------------
# URL without password - use DB_PASSWORD separately for security
# Format: postgresql://user:@host:port/database
# DB_URL=postgresql://user:@localhost:5432/auth_db
# DB_PASSWORD=your-database-password
# DB_PASSWORD_FILE=/run/secrets/db_password

# Connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_CONNECT_TIMEOUT=30

# ----------------------------------------------------------------------------
# S3 STORAGE (optional)
# ----------------------------------------------------------------------------
#S3_URL=https://s3.example.com/bucket-name/
#S3_ACCESS_KEY_ID=your-access-key-id
#S3_SECRET_ACCESS_KEY=your-secret-access-key
# S3_SECRET_ACCESS_KEY_FILE=/run/secrets/s3_secret

# ----------------------------------------------------------------------------
# GEOIP (optional)
# ----------------------------------------------------------------------------
# MaxMind GeoLite2-Country database path
# Download from: https://github.com/wp-statistics/GeoLite2-Country
# Note: Path is set in Dockerfile ENV for Cloud Run (/srv/assets/GeoLite2-Country.mmdb)
# GEOIP_DB_PATH is intentionally not set here to use the container default

# ----------------------------------------------------------------------------
# EMAIL
# ----------------------------------------------------------------------------
# Providers: smtp, mailjet
EMAIL_PROVIDER=mailjet
EMAIL_SENDER=Auth Robot <no-reply@dmitrii.app>

# ----------------------------------------------------------------------------
# SMTP (when EMAIL_PROVIDER=smtp)
# ----------------------------------------------------------------------------
# Format: smtp://user@host:port?tls=<mode> or smtps://user@host:port
# TLS modes: starttls, none (smtps:// implies implicit TLS)
# Examples:
#   smtp://user@smtp.gmail.com:587?tls=starttls   (STARTTLS)
#   smtps://user@smtp.gmail.com:465               (Implicit TLS)
#   smtp://localhost:1025?tls=none                (Local dev - MailHog/MailCatcher)
#SMTP_URL=smtp://user@smtp.example.com:587?tls=starttls
#SMTP_PASSWORD=your-smtp-password
# SMTP_PASSWORD_FILE=/run/secrets/smtp_password

# ----------------------------------------------------------------------------
# MAILJET (when EMAIL_PROVIDER=mailjet)
# ----------------------------------------------------------------------------
#MAILJET_API_KEY=your-mailjet-api-key
#MAILJET_API_SECRET=your-mailjet-api-secret
# MAILJET_API_SECRET_FILE=/run/secrets/mailjet_secret
MAILJET_WELCOME_TEMPLATE_ID=7654682
MAILJET_PASSWORD_RESET_TEMPLATE_ID=7654629
MAILJET_PASSWORD_CHANGED_TEMPLATE_ID=7654700

